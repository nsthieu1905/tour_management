<div
  id="loginPage"
  class="fixed inset-0 bg-gradient-to-br from-blue-600 via-purple-600 to-blue-800 flex items-center justify-center z-50"
>
  <div class="absolute inset-0 bg-black opacity-20"></div>

  <!-- Animated Background Elements -->
  <div class="absolute inset-0 overflow-hidden">
    <div
      class="absolute -top-40 -right-32 w-80 h-80 bg-white opacity-10 rounded-full animate-pulse"
    ></div>
    <div
      class="absolute -bottom-40 -left-32 w-96 h-96 bg-white opacity-5 rounded-full animate-pulse"
      style="animation-delay: 1s"
    ></div>
    <div
      class="absolute top-1/2 left-1/4 w-64 h-64 bg-white opacity-5 rounded-full animate-pulse"
      style="animation-delay: 2s"
    ></div>
  </div>

  <div
    class="relative bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md mx-4 transform transition-all duration-300"
  >
    <!-- Logo and Title -->
    <div class="text-center mb-8">
      <div
        class="gradient-bg p-4 rounded-full w-20 h-20 mx-auto mb-4 flex items-center justify-center"
      >
        <i class="fas fa-map-marked-alt text-white text-2xl"></i>
      </div>
      <h1 class="text-3xl font-bold text-gray-900 mb-2">TravelSmart</h1>
    </div>

    <!-- Login Form -->
    <form id="loginForm" class="space-y-6" novalidate>
      <!-- Email Field -->
      <div class="relative">
        <label class="block text-sm font-medium text-gray-700 mb-2">
          <i class="fas fa-envelope mr-2"></i>Email
        </label>
        <input
          type="email"
          id="email"
          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 pl-12"
          placeholder="Nhập email"
        />
        <i class="fas fa-envelope absolute left-4 top-11 text-gray-400"></i>
        <span
          id="emailError"
          class="text-red-500 text-sm mt-1.5 block font-medium hidden"
        >
          <i class="fas fa-exclamation-circle mr-1"></i
          ><span id="emailErrorMsg"></span>
        </span>
      </div>

      <!-- Password Field -->
      <div class="relative">
        <label class="block text-sm font-medium text-gray-700 mb-2">
          <i class="fas fa-lock mr-2"></i>Mật khẩu
        </label>
        <input
          type="password"
          id="password"
          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 pl-12 pr-12"
          placeholder="Nhập mật khẩu"
        />
        <i class="fas fa-lock absolute left-4 top-11 text-gray-400"></i>
        <button
          type="button"
          onclick="togglePassword()"
          class="absolute right-4 top-11 text-gray-400 hover:text-gray-600"
        >
          <i class="fas fa-eye" id="passwordToggle"></i>
        </button>
        <span
          id="passwordError"
          class="text-red-500 text-sm mt-1.5 block font-medium hidden"
        >
          <i class="fas fa-exclamation-circle mr-1"></i
          ><span id="passwordErrorMsg"></span>
        </span>
      </div>

      <!-- Remember Me & Forgot Password -->
      <div class="flex items-center justify-between">
        <label class="flex items-center">
          <input
            type="checkbox"
            id="rememberMe"
            class="rounded border-gray-300 text-blue-600 focus:ring-blue-500"
          />
          <span class="ml-2 text-sm text-gray-600">Ghi nhớ đăng nhập</span>
        </label>
        <a
          href="#"
          class="text-sm text-blue-600 hover:text-blue-800 font-medium"
          >Quên mật khẩu?</a
        >
      </div>

      <!-- Error Message -->
      <div
        id="loginError"
        class="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg hidden"
      >
        <i class="fas fa-exclamation-triangle mr-2"></i
        ><span id="errorMessage"></span>
      </div>

      <!-- Login Button -->
      <button
        type="submit"
        class="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white font-semibold py-3 rounded-lg hover:shadow-lg transform hover:scale-[1.02] transition-all duration-200 flex items-center justify-center"
      >
        <i class="fas fa-sign-in-alt mr-2"></i>Đăng Nhập
      </button>

      <!-- Loading State -->
      <div id="loadingSpinner" class="hidden flex items-center justify-center">
        <div
          class="animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"
        ></div>
        <span class="ml-2 text-gray-600">Đang xử lý...</span>
      </div>
    </form>

    <!-- Register Link -->
    <div class="mt-6 text-center">
      <p class="text-gray-600">
        Chưa có tài khoản?
        <a
          href="/client/auth/register"
          class="text-blue-600 hover:text-blue-800 font-semibold"
          >Đăng ký ngay</a
        >
      </p>
    </div>
  </div>
</div>

<script src="/utils/auth-helper-client.js"></script>
<script>
  function togglePassword() {
    const passwordInput = document.getElementById("password");
    const passwordToggle = document.getElementById("passwordToggle");

    if (passwordInput.type === "password") {
      passwordInput.type = "text";
      passwordToggle.classList.remove("fa-eye");
      passwordToggle.classList.add("fa-eye-slash");
    } else {
      passwordInput.type = "password";
      passwordToggle.classList.remove("fa-eye-slash");
      passwordToggle.classList.add("fa-eye");
    }
  }

  document.getElementById("loginForm").addEventListener("submit", async (e) => {
    e.preventDefault();

    // Clear previous errors
    document.getElementById("loginError").classList.add("hidden");
    document.getElementById("emailError").classList.add("hidden");
    document.getElementById("passwordError").classList.add("hidden");

    // Get values
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value;
    const rememberMe = document.getElementById("rememberMe").checked;

    // Validation
    let isValid = true;
    if (!email) {
      document.getElementById("emailError").classList.remove("hidden");
      document.getElementById("emailErrorMsg").textContent =
        "Email không được để trống";
      isValid = false;
    } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
      document.getElementById("emailError").classList.remove("hidden");
      document.getElementById("emailErrorMsg").textContent =
        "Email không hợp lệ";
      isValid = false;
    }

    if (!password) {
      document.getElementById("passwordError").classList.remove("hidden");
      document.getElementById("passwordErrorMsg").textContent =
        "Mật khẩu không được để trống";
      isValid = false;
    }

    if (!isValid) return;

    // Show loading
    document.getElementById("loadingSpinner").classList.remove("hidden");

    try {
      const result = await window.clientAuthHelper.login(
        email,
        password,
        rememberMe
      );

      if (result.success) {
        // Redirect to home or dashboard
        window.location.href = "/";
      } else {
        document.getElementById("loginError").classList.remove("hidden");
        document.getElementById("errorMessage").textContent =
          result.message || "Đăng nhập thất bại";
      }
    } catch (error) {
      console.error("Login error:", error);
      document.getElementById("loginError").classList.remove("hidden");
      document.getElementById("errorMessage").textContent =
        error.message || "Lỗi kết nối";
    } finally {
      document.getElementById("loadingSpinner").classList.add("hidden");
    }
  });
</script>
