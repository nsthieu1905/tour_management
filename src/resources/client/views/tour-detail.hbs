{{!--
<style>
  /* Lightbox animations */
  #lightbox {
    animation: fadeIn 0.3s ease-in-out;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  #lightbox-img {
    animation: zoomIn 0.3s ease-in-out;
  }

  @keyframes zoomIn {
    from {
      transform: scale(0.8);
      opacity: 0;
    }
    to {
      transform: scale(1);
      opacity: 1;
    }
  }

  /* Thumbnail hover effect */
  .lightbox-thumb {
    transition: all 0.2s ease-in-out;
  }

  .lightbox-thumb:hover {
    transform: scale(1.05);
  }

  .lightbox-thumb.border-white {
    border-color: white;
    box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
  }

  /* Hide scrollbar for thumbnails */
  #lightbox-thumbnails::-webkit-scrollbar {
    height: 4px;
  }

  #lightbox-thumbnails::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 2px;
  }

  #lightbox-thumbnails::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.3);
    border-radius: 2px;
  }

  #lightbox-thumbnails::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.5);
  }

  /* Firefox scrollbar */
  #lightbox-thumbnails {
    scrollbar-color: rgba(255, 255, 255, 0.3) rgba(255, 255, 255, 0.1);
    scrollbar-width: thin;
  }

  /* Keyboard navigation */
  @media (hover: hover) {
    #lightbox button:hover {
      text-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
    }
  }
</style>
--}}

<main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
  <!-- Tour Header -->
  <div class="mb-8">
    <h1 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
      {{tour.name}}
    </h1>
    <p class="text-lg text-gray-600">{{tour.description}}</p>
  </div>

  <!-- Main Content -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-12">
    <!-- Gallery -->
    <div class="lg:col-span-2 space-y-8">
      <div class="relative">
        <!-- ·∫¢nh ƒë·∫ßu ti√™n - full width -->
        {{#if tour.images}} {{#if (lookup tour.images 0)}}
        <div
          class="w-full h-96 relative group cursor-pointer rounded-2xl overflow-hidden"
          onclick="openLightbox(0)"
        >
          <img
            src="{{lookup tour.images 0}}"
            alt="{{tour.name}}"
            class="w-full h-full object-cover transition duration-300 group-hover:brightness-75"
          />
          <div
            class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition duration-300 flex items-center justify-center"
          >
            <div
              class="text-white opacity-0 group-hover:opacity-100 transition duration-300"
            >
              <svg
                class="w-12 h-12"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"
                ></path>
              </svg>
            </div>
          </div>
        </div>
        {{/if}}

        <!-- Button xem t·∫•t c·∫£ -->
        {{!--
        <button
          class="absolute top-4 right-4 bg-white bg-opacity-90 text-gray-800 px-4 py-2 rounded-lg text-sm font-semibold hover:bg-opacity-100 transition duration-200 shadow-lg z-10"
          onclick="openLightbox(0)"
        >
          üì∑ Xem t·∫•t c·∫£ ({{tour.images.length}})
        </button>
        --}}

        <!-- ·∫¢nh c√≤n l·∫°i - grid nh·ªè d∆∞·ªõi -->
        <div class="grid grid-cols-4 gap-3 h-24 mt-3">
          {{#if (lookup tour.images 1)}}
          <!-- ·∫¢nh 2 -->
          <div
            class="relative group cursor-pointer h-full rounded-xl overflow-hidden"
            onclick="openLightbox(1)"
          >
            <img
              src="{{lookup tour.images 1}}"
              alt="{{tour.name}} - ·∫¢nh 2"
              class="w-full h-full object-cover transition duration-300 group-hover:brightness-75"
            />
            <div
              class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition duration-300 flex items-center justify-center"
            >
              <div
                class="text-white opacity-0 group-hover:opacity-100 transition duration-300"
              >
                <svg
                  class="w-6 h-6"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"
                  ></path>
                </svg>
              </div>
            </div>
          </div>
          {{/if}} {{#if (lookup tour.images 2)}}
          <!-- ·∫¢nh 3 -->
          <div
            class="relative group cursor-pointer h-full rounded-xl overflow-hidden"
            onclick="openLightbox(2)"
          >
            <img
              src="{{lookup tour.images 2}}"
              alt="{{tour.name}} - ·∫¢nh 3"
              class="w-full h-full object-cover transition duration-300 group-hover:brightness-75"
            />
            <div
              class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition duration-300 flex items-center justify-center"
            >
              <div
                class="text-white opacity-0 group-hover:opacity-100 transition duration-300"
              >
                <svg
                  class="w-6 h-6"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"
                  ></path>
                </svg>
              </div>
            </div>
          </div>
          {{/if}} {{#if (lookup tour.images 3)}}
          <!-- ·∫¢nh 4 -->
          <div
            class="relative group cursor-pointer h-full rounded-xl overflow-hidden"
            onclick="openLightbox(3)"
          >
            <img
              src="{{lookup tour.images 3}}"
              alt="{{tour.name}} - ·∫¢nh 4"
              class="w-full h-full object-cover transition duration-300 group-hover:brightness-75"
            />
            <div
              class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition duration-300 flex items-center justify-center"
            >
              <div
                class="text-white opacity-0 group-hover:opacity-100 transition duration-300"
              >
                <svg
                  class="w-6 h-6"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"
                  ></path>
                </svg>
              </div>
            </div>
          </div>
          {{/if}} {{#if (lookup tour.images 4)}}
          <!-- ·∫¢nh 5 - n√∫t xem th√™m -->
          <div
            class="relative group cursor-pointer h-full rounded-xl overflow-hidden bg-gray-800"
            onclick="openLightbox(4)"
          >
            <img
              src="{{lookup tour.images 4}}"
              alt="{{tour.name}} - ·∫¢nh 5"
              class="w-full h-full object-cover transition duration-300 group-hover:brightness-75 opacity-60 group-hover:opacity-100"
            />
            <div
              class="absolute inset-0 bg-black bg-opacity-30 group-hover:bg-opacity-20 transition duration-300 flex items-center justify-center"
            >
              <div class="text-white text-center">
                <div class="text-2xl font-bold">
                  +{{subtract tour.images.length 4}}
                </div>
                <div class="text-xs">Xem th√™m</div>
              </div>
            </div>
          </div>
          {{/if}} {{/if}}
        </div>
      </div>

      <!-- Departure Calendar -->
      <div class="bg-white rounded-2xl shadow-md p-6">
        <h2 class="text-2xl font-bold text-gray-900 mb-6">L·ªãch kh·ªüi h√†nh</h2>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <!-- Month Picker (Left) -->
          <div class="md:col-span-1">
            <h3 class="font-semibold text-gray-900 mb-4">Ch·ªçn th√°ng</h3>
            <div class="space-y-2 max-h-96 overflow-y-auto" id="month-list">
              <!-- Populated by JavaScript -->
            </div>
          </div>

          <!-- Calendar Days (Right) -->
          <div class="md:col-span-2">
            <div class="flex items-center justify-between mb-4">
              <button
                onclick="prevMonth()"
                class="p-2 hover:bg-gray-100 rounded-lg"
              >
                ‚Üê
              </button>
              <h3
                class="font-semibold text-gray-900 text-lg"
                id="current-month"
              >
                {{#if tour.departureDates}} {{#with (lookup tour.departureDates
                0)}} {{formatMonthYear this.date}} {{/with}} {{/if}}
              </h3>
              <button
                onclick="nextMonth()"
                class="p-2 hover:bg-gray-100 rounded-lg"
              >
                ‚Üí
              </button>
            </div>

            <div class="grid grid-cols-7 gap-2 mb-4">
              <div class="text-center font-semibold text-gray-600 py-2 text-sm">
                T2
              </div>
              <div class="text-center font-semibold text-gray-600 py-2 text-sm">
                T3
              </div>
              <div class="text-center font-semibold text-gray-600 py-2 text-sm">
                T4
              </div>
              <div class="text-center font-semibold text-gray-600 py-2 text-sm">
                T5
              </div>
              <div class="text-center font-semibold text-gray-600 py-2 text-sm">
                T6
              </div>
              <div class="text-center font-semibold text-gray-600 py-2 text-sm">
                T7
              </div>
              <div class="text-center font-semibold text-gray-600 py-2 text-sm">
                CN
              </div>
            </div>

            <div
              class="grid grid-cols-7 gap-2"
              id="calendar-grid"
              data-departures="{{json tour.departureDates}}"
            >
              <!-- Populated by JavaScript -->
            </div>

            <p class="text-red-500 text-sm mt-4 text-center">
              Qu√Ω kh√°ch vui l√≤ng ch·ªçn ng√†y ph√π h·ª£p
            </p>
          </div>
        </div>
      </div>

      <!-- Highlights -->
      <div class="bg-blue-50 rounded-2xl p-8">
        <h2 class="text-2xl font-bold text-gray-900 mb-6">
          ‚ú® ƒêi·ªÉm nh·∫•n c·ªßa ch∆∞∆°ng tr√¨nh
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="flex items-start space-x-3 animate-fade-in">
            <div class="text-2xl">üèØ</div>
            <div>
              <h3 class="font-semibold text-gray-900 mb-2">Kh√°m ph√° Bangkok</h3>
              <p class="text-gray-600">
                Tham quan Cung ƒëi·ªán Ho√†ng gia, Ch√πa Ph·∫≠t V√†ng v√† ch·ª£ n·ªïi Damnoen
                Saduak
              </p>
            </div>
          </div>
          <div class="flex items-start space-x-3 animate-fade-in">
            <div class="text-2xl">üèñÔ∏è</div>
            <div>
              <h3 class="font-semibold text-gray-900 mb-2">
                Th∆∞ gi√£n t·∫°i Pattaya
              </h3>
              <p class="text-gray-600">
                T·∫Øm bi·ªÉn, tham quan ƒë·∫£o Coral v√† th∆∞·ªüng th·ª©c show Alcazar n·ªïi
                ti·∫øng
              </p>
            </div>
          </div>
          <div class="flex items-start space-x-3 animate-fade-in">
            <div class="text-2xl">üçΩÔ∏è</div>
            <div>
              <h3 class="font-semibold text-gray-900 mb-2">·∫®m th·ª±c ƒë·∫∑c s·∫Øc</h3>
              <p class="text-gray-600">
                Th∆∞·ªüng th·ª©c buffet h·∫£i s·∫£n, Tom Yum Kung v√† c√°c m√≥n ƒÉn truy·ªÅn
                th·ªëng Th√°i
              </p>
            </div>
          </div>
          <div class="flex items-start space-x-3 animate-fade-in">
            <div class="text-2xl">üõçÔ∏è</div>
            <div>
              <h3 class="font-semibold text-gray-900 mb-2">
                Mua s·∫Øm th·ªèa th√≠ch
              </h3>
              <p class="text-gray-600">
                Gh√© thƒÉm Platinum Mall, MBK Center v√† ch·ª£ ƒë√™m Chatuchak
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Additional Info -->
      <div class="bg-white rounded-2xl shadow-md p-6">
        <h2 class="text-2xl font-bold text-gray-900 mb-6">
          üìã Th√¥ng tin th√™m v·ªÅ chuy·∫øn ƒëi
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
          <div class="text-center">
            <div class="text-3xl mb-2">‚úàÔ∏è</div>
            <h3 class="font-semibold text-gray-900 mb-2">V·∫≠n chuy·ªÉn</h3>
            <p class="text-sm text-gray-600">
              M√°y bay kh·ª© h·ªìi, xe du l·ªãch ƒë·ªùi m·ªõi
            </p>
          </div>
          <div class="text-center">
            <div class="text-3xl mb-2">üè®</div>
            <h3 class="font-semibold text-gray-900 mb-2">Kh√°ch s·∫°n</h3>
            <p class="text-sm text-gray-600">
              Kh√°ch s·∫°n 4-5 sao, v·ªã tr√≠ trung t√¢m
            </p>
          </div>
          <div class="text-center">
            <div class="text-3xl mb-2">üçΩÔ∏è</div>
            <h3 class="font-semibold text-gray-900 mb-2">ƒÇn u·ªëng</h3>
            <p class="text-sm text-gray-600">
              Buffet s√°ng, c√°c b·ªØa ch√≠nh theo tour
            </p>
          </div>
          <div class="text-center">
            <div class="text-3xl mb-2">üë®‚Äçüíº</div>
            <h3 class="font-semibold text-gray-900 mb-2">H∆∞·ªõng d·∫´n vi√™n</h3>
            <p class="text-sm text-gray-600">
              HDV ti·∫øng Vi·ªát nhi·ªÅu kinh nghi·ªám
            </p>
          </div>
        </div>
      </div>

      <!-- Itinerary -->
      <div class="bg-white rounded-2xl shadow-md p-6">
        <h2 class="text-2xl font-bold text-gray-900 mb-6">
          L·ªãch tr√¨nh chi ti·∫øt
        </h2>
        {{#if tour.itinerary}}
        <div class="space-y-4">
          {{#each tour.itinerary as |item index|}}
          <div class="border border-gray-200 rounded-xl">
            <button
              class="w-full text-left p-4 hover:bg-gray-50 transition duration-200 flex items-center justify-between"
              onclick="toggleAccordion('itinerary-day-{{item.day}}')"
            >
              <div class="flex items-center space-x-3">
                <span
                  class="bg-blue-100 text-blue-600 px-3 py-1 rounded-full text-sm font-semibold"
                  >Ng√†y {{item.day}}</span
                >
                <span class="font-semibold">{{item.destinations}}</span>
              </div>
              <svg
                id="itinerary-day-{{item.day}}-icon"
                class="w-5 h-5 text-gray-400 transform transition-transform duration-200"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                ></path>
              </svg>
            </button>
            <div
              id="itinerary-day-{{item.day}}"
              class="hidden p-4 pt-0 text-gray-600"
            >
              <p>{{item.description}}</p>
            </div>
          </div>
          {{/each}}
        </div>
        {{else}}
        <div class="text-gray-500 text-center py-6">
          Ch∆∞a c√≥ l·ªãch tr√¨nh chi ti·∫øt
        </div>
        {{/if}}
      </div>

      <!-- Important Information -->
      <div class="bg-white rounded-2xl shadow-md p-6">
        <h2 class="text-2xl font-bold text-gray-900 mb-6">
          ‚ö†Ô∏è Nh·ªØng th√¥ng tin c·∫ßn l∆∞u √Ω
        </h2>
        <div class="space-y-4">
          <div class="border border-gray-200 rounded-xl">
            <button
              class="w-full text-left p-4 hover:bg-gray-50 transition duration-200 flex items-center justify-between"
              onclick="toggleAccordion('include')"
            >
              <span class="font-semibold text-green-600"
                >‚úÖ Gi√° tour bao g·ªìm</span
              >
              <svg
                id="include-icon"
                class="w-5 h-5 text-gray-400 transform transition-transform duration-200"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                ></path>
              </svg>
            </button>
            <div id="include" class="hidden p-4 pt-0 text-gray-600">
              <ul class="space-y-2">
                <li>‚Ä¢ V√© m√°y bay kh·ª© h·ªìi TP.HCM - Bangkok</li>
                <li>‚Ä¢ Kh√°ch s·∫°n 4-5 sao (2 ng∆∞·ªùi/ph√≤ng)</li>
                <li>‚Ä¢ C√°c b·ªØa ƒÉn theo ch∆∞∆°ng tr√¨nh</li>
                <li>‚Ä¢ Xe du l·ªãch ƒë·ªùi m·ªõi c√≥ m√°y l·∫°nh</li>
                <li>‚Ä¢ H∆∞·ªõng d·∫´n vi√™n ti·∫øng Vi·ªát</li>
                <li>‚Ä¢ V√© tham quan c√°c ƒëi·ªÉm trong ch∆∞∆°ng tr√¨nh</li>
                <li>‚Ä¢ B·∫£o hi·ªÉm du l·ªãch</li>
              </ul>
            </div>
          </div>

          <div class="border border-gray-200 rounded-xl">
            <button
              class="w-full text-left p-4 hover:bg-gray-50 transition duration-200 flex items-center justify-between"
              onclick="toggleAccordion('exclude')"
            >
              <span class="font-semibold text-red-600"
                >‚ùå Gi√° tour kh√¥ng bao g·ªìm</span
              >
              <svg
                id="exclude-icon"
                class="w-5 h-5 text-gray-400 transform transition-transform duration-200"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                ></path>
              </svg>
            </button>
            <div id="exclude" class="hidden p-4 pt-0 text-gray-600">
              <ul class="space-y-2">
                <li>‚Ä¢ H·ªô chi·∫øu (c√≤n h·∫°n √≠t nh·∫•t 6 th√°ng)</li>
                <li>‚Ä¢ Chi ph√≠ c√° nh√¢n: gi·∫∑t ·ªßi, ƒëi·ªán tho·∫°i, internet</li>
                <li>‚Ä¢ Ti·ªÅn tip cho HDV v√† t√†i x·∫ø</li>
                <li>‚Ä¢ C√°c b·ªØa ƒÉn ngo√†i ch∆∞∆°ng tr√¨nh</li>
                <li>‚Ä¢ Ph·ª• thu ph√≤ng ƒë∆°n: 1.200.000ƒë</li>
              </ul>
            </div>
          </div>

          <div class="border border-gray-200 rounded-xl">
            <button
              class="w-full text-left p-4 hover:bg-gray-50 transition duration-200 flex items-center justify-between"
              onclick="toggleAccordion('cancel')"
            >
              <span class="font-semibold text-orange-600"
                >üìã Ch√≠nh s√°ch h·ªßy tour</span
              >
              <svg
                id="cancel-icon"
                class="w-5 h-5 text-gray-400 transform transition-transform duration-200"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                ></path>
              </svg>
            </button>
            <div id="cancel" class="hidden p-4 pt-0 text-gray-600">
              <ul class="space-y-2">
                <li>‚Ä¢ H·ªßy tr∆∞·ªõc 30 ng√†y: kh√¥ng m·∫•t ph√≠</li>
                <li>‚Ä¢ H·ªßy t·ª´ 15-29 ng√†y: m·∫•t 50% ti·ªÅn tour</li>
                <li>‚Ä¢ H·ªßy t·ª´ 7-14 ng√†y: m·∫•t 70% ti·ªÅn tour</li>
                <li>‚Ä¢ H·ªßy d∆∞·ªõi 7 ng√†y: m·∫•t 100% ti·ªÅn tour</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Booking Card -->
    <div class="lg:col-span-1">
      <div
        class="bg-white rounded-2xl shadow-lg p-6 border border-gray-100 lg:sticky lg:top-24"
      >
        <!-- Price Section -->
        <div class="text-center mb-6 relative">
          {{!--
          <div
            class="absolute -top-3 -right-3 bg-red-500 text-white text-xs px-2 py-1 rounded-full animate-pulse"
          >
            üî• Hot Deal
          </div>
          --}}
          <div class="text-sm text-gray-500 mb-2">Gi√° t·ª´</div>
          <div class="text-3xl font-bold text-orange-500 mb-1">
            {{tour.price}}
          </div>
          <div class="text-sm text-gray-500 line-through">7.200.000ƒë</div>
          <div class="text-xs text-green-600 font-semibold">
            Ti·∫øt ki·ªám 810.000ƒë
          </div>
        </div>

        <!-- Guest Counter -->
        <div class="mb-4 p-3 bg-gray-50 rounded-xl">
          <div class="text-sm text-gray-600 mb-2">S·ªë l∆∞·ª£ng kh√°ch</div>
          <div class="flex items-center justify-between">
            <div class="flex items-center space-x-3">
              <button
                onclick="changeGuests(-1)"
                class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center hover:bg-gray-300 transition duration-200"
              >
                -
              </button>
              <span id="guest-count" class="font-semibold">1</span>
              <button
                onclick="changeGuests(1)"
                class="w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center hover:bg-blue-700 transition duration-200"
              >
                +
              </button>
            </div>
            <div class="text-sm text-gray-600">
              T·ªïng:
              <span id="total-price" class="font-bold text-orange-500"
                >{{tour.price}}ƒë</span
              >
            </div>
          </div>
        </div>

        <button
          onclick="openBookingModal()"
          class="w-full bg-gradient-to-r from-blue-600 to-blue-700 text-white py-3 px-4 rounded-xl font-semibold hover:from-blue-700 hover:to-blue-800 transition duration-200 mb-4 shadow-lg"
        >
          üéØ Ch·ªçn ng√†y kh·ªüi h√†nh
        </button>

        <div class="space-y-3 text-sm mb-4">
          <div class="flex justify-between">
            <span class="text-gray-600">M√£ tour:</span>
            <span class="font-semibold text-blue-600">TL001</span>
          </div>
          <div class="flex justify-between">
            <span class="text-gray-600">Th·ªùi gian:</span>
            <span class="font-semibold"
              >{{tour.duration.days}} ng√†y {{tour.duration.nights}} ƒë√™m</span
            >
          </div>
          <div class="flex justify-between">
            <span class="text-gray-600">Kh·ªüi h√†nh:</span>
            <span class="font-semibold">TP.HCM</span>
          </div>
          <div class="flex justify-between">
            <span class="text-gray-600">C√≤n l·∫°i:</span>
            <span class="font-semibold text-red-500">8 ch·ªó</span>
          </div>
        </div>

        <!-- Rating -->
        <div
          class="flex items-center justify-center space-x-2 mb-4 p-3 bg-yellow-50 rounded-xl"
        >
          <div class="flex text-yellow-400">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
          <span class="text-sm font-semibold">{{tour.rating.average}}/5</span>
          <span class="text-xs text-gray-600"
            >({{tour.rating.count}} ƒë√°nh gi√°)</span
          >
        </div>

        <button
          onclick="openContactModal()"
          class="w-full border-2 border-orange-500 text-orange-500 py-2 px-4 rounded-xl font-semibold hover:bg-orange-50 transition duration-200 mb-3"
        >
          üìû Li√™n h·ªá t∆∞ v·∫•n
        </button>

        <button
          onclick="addToWishlist()"
          class="w-full border border-gray-300 text-gray-600 py-2 px-4 rounded-xl font-semibold hover:bg-gray-50 transition duration-200 flex items-center justify-center space-x-2"
        >
          <span id="wishlist-icon">ü§ç</span>
          <span id="wishlist-text">Y√™u th√≠ch</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Main Content Section -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-12">
    <!-- Left Column -->
    <div class="lg:col-span-2 space-y-8"></div>
  </div>

  <!-- Customer Reviews -->
  {{!--
  <div class="mb-12">
    <h2 class="text-2xl font-bold text-gray-900 mb-8">
      üí¨ ƒê√°nh gi√° t·ª´ kh√°ch h√†ng
    </h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
      <div class="review-card text-white rounded-2xl p-6">
        <div class="flex items-center mb-4">
          <div
            class="w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center text-2xl"
          >
            üë®
          </div>
          <div class="ml-3">
            <div class="font-semibold">Anh Minh</div>
            <div class="text-sm opacity-90">TP.HCM</div>
          </div>
          <div class="ml-auto text-yellow-300">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
        </div>
        <p class="text-sm opacity-90">
          "Tour r·∫•t tuy·ªát v·ªùi! HDV nhi·ªát t√¨nh, l·ªãch tr√¨nh h·ª£p l√Ω. Gia ƒë√¨nh t√¥i
          r·∫•t h√†i l√≤ng v·ªõi chuy·∫øn ƒëi n√†y."
        </p>
        <div class="text-xs opacity-75 mt-3">2 tu·∫ßn tr∆∞·ªõc</div>
      </div>

      <div class="review-card text-white rounded-2xl p-6">
        <div class="flex items-center mb-4">
          <div
            class="w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center text-2xl"
          >
            üë©
          </div>
          <div class="ml-3">
            <div class="font-semibold">Ch·ªã Lan</div>
            <div class="text-sm opacity-90">H√† N·ªôi</div>
          </div>
          <div class="ml-auto text-yellow-300">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
        </div>
        <p class="text-sm opacity-90">
          "Kh√°ch s·∫°n ƒë·∫πp, ƒë·ªì ƒÉn ngon. ƒê·∫∑c bi·ªát show Alcazar r·∫•t ·∫•n t∆∞·ª£ng. S·∫Ω ƒëi
          tour v·ªõi VietTravel l·∫ßn n·ªØa!"
        </p>
        <div class="text-xs opacity-75 mt-3">1 th√°ng tr∆∞·ªõc</div>
      </div>

      <div class="review-card text-white rounded-2xl p-6">
        <div class="flex items-center mb-4">
          <div
            class="w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center text-2xl"
          >
            üë®
          </div>
          <div class="ml-3">
            <div class="font-semibold">Anh Tu·∫•n</div>
            <div class="text-sm opacity-90">ƒê√† N·∫µng</div>
          </div>
          <div class="ml-auto text-yellow-300">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
        </div>
        <p class="text-sm opacity-90">
          "Gi√° c·∫£ h·ª£p l√Ω, d·ªãch v·ª• t·ªët. ƒê·∫£o Coral r·∫•t ƒë·∫πp, n∆∞·ªõc trong xanh. C·∫£m
          ∆°n VietTravel!"
        </p>
        <div class="text-xs opacity-75 mt-3">3 tu·∫ßn tr∆∞·ªõc</div>
      </div>
    </div>
  </div>
  --}}

  <!-- Other Tours -->
  {{!--
  <div class="mb-12">
    <h2 class="text-2xl font-bold text-gray-900 mb-8">
      üåü C√°c ch∆∞∆°ng tr√¨nh tour kh√°c
    </h2>
    {{#if otherTours}}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {{#each otherTours as |otherTour|}}
      <div
        class="tour-card bg-white rounded-2xl shadow-md overflow-hidden transition duration-200 hover:shadow-lg"
      >
        <img
          src="{{#if otherTour.images}}{{lookup otherTour.images 0}}{{else}}https://via.placeholder.com/400x250{{/if}}"
          alt="{{otherTour.name}}"
          class="w-full h-48 object-cover"
        />
        <div class="p-6">
          <h3 class="font-bold text-lg text-gray-900 mb-2">
            {{otherTour.name}}
          </h3>
          <p class="text-gray-600 text-sm mb-4">{{otherTour.description}}</p>
          <div class="flex items-center justify-between">
            <div class="text-orange-500 font-bold text-xl">
              {{otherTour.price}}ƒë
            </div>
            <a
              href="/tours/{{otherTour._id}}"
              class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-blue-700 transition duration-200"
            >
              Xem chi ti·∫øt
            </a>
          </div>
        </div>
      </div>
      {{/each}}
    </div>
    {{else}}
    <p class="text-gray-600 text-center py-8">Kh√¥ng c√≥ tour kh√°c kh·∫£ d·ª•ng</p>
    {{/if}}
  </div>
  --}}
</main>

<!-- Floating Action Button -->
<div class="floating-btn">
  <button
    onclick="openBookingModal()"
    class="bg-gradient-to-r from-orange-500 to-red-500 text-white p-4 rounded-full shadow-2xl hover:from-orange-600 hover:to-red-600 transition duration-300"
  >
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.5 6M7 13l-1.5-6m0 0h15M17 13v6a2 2 0 01-2 2H9a2 2 0 01-2-2v-6"
      ></path>
    </svg>
  </button>
</div>

<!-- Lightbox Modal -->
<div
  id="lightbox"
  class="fixed inset-0 bg-black bg-opacity-95 z-50 hidden flex flex-col items-center justify-between p-4"
>
  <!-- Close button -->
  <button
    onclick="closeLightbox()"
    class="absolute top-6 right-6 text-white text-3xl hover:text-gray-300 transition duration-200 z-10"
  >
    √ó
  </button>

  <!-- Main image container with fixed height -->
  <div class="flex items-center justify-center w-full h-[70vh] mt-12">
    <button
      onclick="prevImage()"
      class="absolute left-4 text-white text-5xl hover:text-gray-300 transition duration-200 hover:scale-110 z-20"
    >
      ‚ùÆ
    </button>
    <img
      id="lightbox-img"
      src=""
      alt=""
      class="max-w-full max-h-full object-contain"
    />
    <button
      onclick="nextImage()"
      class="absolute right-4 text-white text-5xl hover:text-gray-300 transition duration-200 hover:scale-110 z-20"
    >
      ‚ùØ
    </button>
  </div>

  <!-- Counter and title -->
  <div class="text-white text-center mt-4 mb-4">
    <div id="lightbox-caption" class="text-lg font-semibold mb-2">
      {{tour.name}}
    </div>
    <div class="text-sm opacity-75">
      <span id="lightbox-counter">1 / {{tour.images.length}}</span>
    </div>
  </div>

  <!-- Thumbnails with scroll -->
  <div
    class="flex gap-3 overflow-x-auto pb-4 w-full justify-center px-4 scrollbar-hide"
    id="lightbox-thumbnails"
  >
    {{#each tour.images as |image idx|}} {{#if image}}
    <img
      src="{{image}}"
      alt="Thumbnail {{idx}}"
      onclick="openLightbox({{idx}})"
      class="h-20 w-24 object-cover rounded cursor-pointer hover:opacity-75 transition duration-200 border-2 border-transparent lightbox-thumb flex-shrink-0"
      data-original-index="{{idx}}"
    />
    {{/if}} {{/each}}
  </div>
</div>

<!-- Booking Modal -->
<div
  id="booking-modal"
  class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4"
>
  <div class="bg-white rounded-2xl max-w-md w-full p-6 animate-fade-in">
    <div class="flex items-center justify-between mb-6">
      <h3 class="text-xl font-bold text-gray-900">ƒê·∫∑t tour ngay</h3>
      <button
        onclick="closeBookingModal()"
        class="text-gray-400 hover:text-gray-600 text-2xl"
      >
        √ó
      </button>
    </div>

    <form onsubmit="submitBooking(event)" class="space-y-4">
      <div>
        <label
          for="customer-name"
          class="block text-sm font-semibold text-gray-700 mb-2"
          >H·ªç v√† t√™n</label
        >
        <input
          type="text"
          id="customer-name"
          required
          class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"
        />
      </div>

      <div>
        <label
          for="customer-phone"
          class="block text-sm font-semibold text-gray-700 mb-2"
          >S·ªë ƒëi·ªán tho·∫°i</label
        >
        <input
          type="tel"
          id="customer-phone"
          required
          class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"
        />
      </div>

      <div>
        <label
          for="customer-email"
          class="block text-sm font-semibold text-gray-700 mb-2"
          >Email</label
        >
        <input
          type="email"
          id="customer-email"
          required
          class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"
        />
      </div>

      <div>
        <label
          for="departure-date"
          class="block text-sm font-semibold text-gray-700 mb-2"
          >Ng√†y kh·ªüi h√†nh</label
        >
        <select
          id="departure-date"
          required
          class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"
        >
          <option value="">Ch·ªçn ng√†y kh·ªüi h√†nh</option>
          <option value="2024-12-05">05/12/2024 - 6.390.000ƒë</option>
          <option value="2024-12-12">12/12/2024 - 6.590.000ƒë</option>
          <option value="2024-12-19">19/12/2024 - 6.390.000ƒë</option>
          <option value="2024-12-26">26/12/2024 - 6.790.000ƒë</option>
        </select>
      </div>

      <div class="bg-gray-50 rounded-xl p-4">
        <div class="flex justify-between items-center mb-2">
          <span class="text-sm text-gray-600">S·ªë kh√°ch:</span>
          <span id="modal-guest-count" class="font-semibold">2</span>
        </div>
        <div class="flex justify-between items-center">
          <span class="text-sm text-gray-600">T·ªïng ti·ªÅn:</span>
          <span id="modal-total-price" class="font-bold text-orange-500"
            >12.780.000ƒë</span
          >
        </div>
      </div>

      <button
        type="submit"
        class="w-full bg-gradient-to-r from-blue-600 to-blue-700 text-white py-3 px-4 rounded-xl font-semibold hover:from-blue-700 hover:to-blue-800 transition duration-200"
      >
        üéØ X√°c nh·∫≠n ƒë·∫∑t tour
      </button>
    </form>
  </div>
</div>

<!-- Contact Modal -->
<div
  id="contact-modal"
  class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4"
>
  <div class="bg-white rounded-2xl max-w-md w-full p-6 animate-fade-in">
    <div class="flex items-center justify-between mb-6">
      <h3 class="text-xl font-bold text-gray-900">Li√™n h·ªá t∆∞ v·∫•n</h3>
      <button
        onclick="closeContactModal()"
        class="text-gray-400 hover:text-gray-600 text-2xl"
      >
        √ó
      </button>
    </div>

    <div class="space-y-4">
      <div class="flex items-center space-x-4 p-4 bg-blue-50 rounded-xl">
        <div class="text-2xl">üìû</div>
        <div>
          <div class="font-semibold text-gray-900">Hotline 24/7</div>
          <div class="text-blue-600 font-bold">1900 1234</div>
        </div>
      </div>

      <div class="flex items-center space-x-4 p-4 bg-green-50 rounded-xl">
        <div class="text-2xl">üí¨</div>
        <div>
          <div class="font-semibold text-gray-900">Chat Zalo</div>
          <div class="text-green-600 font-bold">0901 234 567</div>
        </div>
      </div>

      <div class="flex items-center space-x-4 p-4 bg-orange-50 rounded-xl">
        <div class="text-2xl">üìß</div>
        <div>
          <div class="font-semibold text-gray-900">Email</div>
          <div class="text-orange-600 font-bold">info@viettravel.com</div>
        </div>
      </div>

      <button
        onclick="closeContactModal()"
        class="w-full bg-gray-600 text-white py-3 px-4 rounded-xl font-semibold hover:bg-gray-700 transition duration-200"
      >
        ƒê√≥ng
      </button>
    </div>
  </div>
</div>

<script>
  // Initialize images array for lightbox - filter out empty images
  const images = [
    {{#each tour.images as |image idx|}}
      {{#if image}}
      {
        src: "{{image}}",
        caption: "{{../tour.name}}"
      }{{#unless @last}},{{/unless}}
      {{/if}}
    {{/each}}
  ];
</script>

<script src="/client/js/tour-detail.js"></script>
