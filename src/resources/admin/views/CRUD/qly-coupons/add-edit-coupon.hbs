<div
  id="addCouponModal"
  class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50"
>
  <div
    class="bg-white rounded-xl shadow-lg max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto"
  >
    <div class="flex justify-between items-center mb-4 p-6 border-b">
      <h3 id="modalTitle" class="text-xl font-semibold text-gray-900">
        Thêm mã giảm giá
      </h3>
      <button
        onclick="hideAddCouponModal()"
        class="text-gray-400 hover:text-gray-600"
      >
        <i class="fas fa-times text-xl"></i>
      </button>
    </div>

    <!-- UNIFIED FORM -->
    <form id="couponForm" class="p-6 space-y-4">
      <!-- Mã code -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2"
          >Mã code <span class="text-red-500">*</span></label
        >
        <input
          type="text"
          name="code"
          class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 uppercase"
          placeholder="VD: SUMMER2025, SAVE50"
          required
        />
      </div>

      <!-- Tên mã -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2"
          >Tên mã <span class="text-red-500">*</span></label
        >
        <input
          type="text"
          name="name"
          class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"
          placeholder="VD: Mùa hè 2025, Giảm 50%"
          required
        />
      </div>

      <!-- Mô tả -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2"
          >Mô tả</label
        >
        <textarea
          name="description"
          rows="2"
          class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"
          placeholder="Mô tả chi tiết về mã khuyến mãi"
        ></textarea>
      </div>

      <!-- Loại giảm -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2"
          >Loại giảm giá <span class="text-red-500">*</span></label
        >
        <select
          name="type"
          id="couponType"
          class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"
          required
          onchange="updateValueLabel()"
        >
          <option value="">Chọn loại</option>
          <option value="percentage">Phần trăm (%)</option>
          <option value="fixed_amount">Số tiền cố định (VNĐ)</option>
          <option value="free_service">Dịch vụ miễn phí</option>
        </select>
      </div>

      <!-- Giá trị giảm -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">
          <span id="valueLabel"
            >Giá trị <span class="text-red-500">*</span></span
          >
        </label>
        <input
          type="number"
          name="value"
          id="couponValue"
          class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"
          placeholder="Nhập giá trị"
          min="0"
          required
        />
      </div>

      <!-- Đơn hàng tối thiểu -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2"
          >Đơn tối thiểu (VNĐ) <span class="text-red-500">*</span></label
        >
        <input
          type="number"
          name="minPurchase"
          class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"
          placeholder="VD: 500000"
          min="0"
          value="0"
        />
      </div>

      <!-- Giảm tối đa -->
      <div id="maxDiscountField">
        <label class="block text-sm font-medium text-gray-700 mb-2"
          >Giảm tối đa (VNĐ) <span class="text-red-500">*</span></label
        >
        <input
          type="number"
          name="maxDiscount"
          class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"
          placeholder="VD: 1000000"
          min="0"
        />
      </div>

      <!-- Ngày bắt đầu -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2"
          >Ngày bắt đầu <span class="text-red-500">*</span></label
        >
        <input
          type="date"
          name="startDate"
          class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"
          required
        />
      </div>

      <!-- Ngày kết thúc -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2"
          >Ngày kết thúc <span class="text-red-500">*</span></label
        >
        <input
          type="date"
          name="endDate"
          class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"
          required
        />
      </div>

      <!-- Giới hạn sử dụng -->
      <div class="grid grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2"
            >Giới hạn tổng (0 = vô hạn)</label
          >
          <input
            type="number"
            name="usageLimit"
            class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"
            placeholder="VD: 100"
            min="0"
            value="0"
          />
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2"
            >Giới hạn/người (0 = vô hạn)</label
          >
          <input
            type="number"
            name="perUserLimit"
            class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"
            placeholder="VD: 1"
            min="0"
            value="1"
          />
        </div>
      </div>

      <!-- Trạng thái -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2"
          >Trạng thái</label
        >
        <select
          name="status"
          class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"
        >
          <option value="active">Hoạt động</option>
          <option value="inactive">Không hoạt động</option>
        </select>
      </div>

      <!-- Buttons -->
      <div class="flex justify-end space-x-3 pt-4">
        <button
          type="button"
          onclick="hideAddCouponModal()"
          class="px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300"
        >
          Hủy
        </button>
        <button
          type="submit"
          id="submitBtn"
          class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600"
        >
          Thêm mã
        </button>
      </div>
    </form>
  </div>
</div>
